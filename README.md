### Описание сервиса

Приложение для обмена сообщениями между двумя пользователями 
на основе event-driven API с Apache Kafka в качестве брокера.

Для отправки и получения сообщений исользуется CLI клиент **ChatClient**.
При запуске он попросит ввести имя пользователя, которое потом будет видно остальным 
и использоваться для получения сообщений. Если клиент, которому отправляется сообщение 
не подключён, оно будет доставлено позже, при первом подлкючении клиента.

Имя должно быть уникальным, если имя уже занято, при подключении пользователь 
получит сообщение об этом. Если необходимо переподключиться с тем же именем, 
нужно указать после имени команду reconnect.

Для работы клиента нужно запустить AsyncApi. Оно предоставляет список клиентов, 
подключает текущего клиента, отправляет сообщения.

### Конфигурация

Для конфигурации Kafka используется файл kafka.properties. Обязательный параметр
bootstrap.servers - хост, на которм развёрнута Kafka. Также можно задать:
- security.protocol - протокол взаимодействия с брокером
- sasl.mechanisms - SASL механизм, используемый для авторизации
- sasl.username - имя пользователя
- sasl.password - пароль

По умолчанию эти параметры закомментированны.

Полный список параметров и их описание можно найти здесь 
[CONFIGURATION.md](https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md)

Для AsyncApi в файле appsetings.json нужно указать только путь к **kafka.properties**

```json
{
  "KafkaClient": {
    "ConfigPath": "kafka.properties"
  }
}
```

Для ChatClient в appsetings.json также нужно указать только путь к **kafka.properties** и 
URL AsyncApi

```json
{
  "KafkaClient": {
    "ConfigPath": "kafka.properties"
  },
  "AsyncApi":{
    "BaseUrl" : "http://localhost:5000"
  }
}

```

### Сборка и запуск

Для сборки проекта AsyncApi и ChatClient под Windows 10 x64, 
нужно перейти в директорию проектов и выполнить команду 
`dotnet publish -c Release -r win10-x64 --output publsih`  
Запустить АПИ и клиента можно из папки **publsih**, запустив AsyncApi.exe и 
ChatClient.exe соотвественно


### Пример работы

Пример работы сервиса можно увидеть на скриншоте [image_1.png](https://github.com/NUTS-COON/Vezdekod.AsyncChat/blob/master/image_1.png)

Здесь поднят АПИ и запущено 3 клиента: alice, bob и carl. Алиса сначала получает 
сообщение от Боба, затем отправляет сообщение Бобу, когда он уже отключился. После 
подлкючения, Боб получает сообщение от Алисы. Карл просматривает список всех участников.